(function($){"use strict";const{__,_x,_n,_nx}=wp.i18n;$.fn.sq_Modal=function(state){var $this=this;var $background=$('<div class="sq-modal-backdrop"></div>');var $parent=$("#sq_wrap").legth?$("#sq_wrap"):$("body");if(typeof state==="undefined"){state="show"}if(state==="show"){var $close=$this.find(".sq-close");if($parent.find(".sq-modal").length){$parent.find(".sq-modal").remove();$parent.find(".sq-modal-backdrop").remove()}$parent.append($this);$parent.append($background);$background.addClass("show").show();$this.addClass("show").show();$("body").trigger("sqd_jsonld_modal_show",[$this]);$close.on("click",function(){$background.remove();$this.remove()})}else{$parent.find(".sq-modal-backdrop").remove();$this.remove();$parent.trigger("sqd_jsonld_modal_hide",[$this])}};$.fn.sq_listenForm=function(){var $form=this;$form.post_id=$form.find("input[name=post_id]").val();$form.term_id=$form.find("input[name=term_id]").val();$form.taxonomy=$form.find("input[name=taxonomy]").val();$form.post_type=$form.find("input[name=post_type]").val();$form.jsonld_type=$form.find("input[name=jsonld_type]").val();$form.sq_listenAddField();$form.sq_listenDeleteField();$form.sq_listenDependency();$form.sq_listenSubmit()};if(!$.isFunction($.sq_showMessage)){$.sq_showMessage=function(text,time){$(".sq_alert").remove();if(text.indexOf("<div>")==-1){text=$('<div class="sq_alert position-fixed fixed-top text-center text-white bg-success m-0 p-3 border border-white sq-position-fixed sq-fixed-top sq-text-center sq-text-white sq-bg-success sq-m-0 sq-p-3 sq-border sq-border-white">'+text+"</div>")}$("body").prepend(text);if(typeof time==="undefined"){time=3e3}setTimeout(function(){text.remove()},time);return text}}$.fn.sq_listenSearch=function(){var $modal=this;$modal.find(".sq_search_schema input").on("keyup",function(){var search=$(this).val().toUpperCase();$modal.find("li").each(function(){if($(this).text().toUpperCase().indexOf(search)!==-1){$(this).show()}else{$(this).hide()}})})};$.fn.sq_listenSubmit=function(){var $form=this;$(".sqp_jsonld_reusable_prepare").on("click",function(){$form.find(".sqp_jsonld_reusable_name").addClass("sq-popup");$form.append($('<div class="sq-modal-backdrop"></div>'));$form.find(".sqp_jsonld_reusable_name").show();$form.find('button[type="submit"]').hide()});$(".sqp_jsonld_reusable_cancel").on("click",function(){var $modal=$(this).parents(".sq-modal:last");$modal.sq_Modal("hide")});$(".sqp_jsonld_reusable_save").on("click",function(){var $button=$(this);var $form=$(this).parents("form:last");$form.find('input[name="action"]').val("sqp_jsonld_reusable_update");$form.find('input[name="_wp_http_referer"]').remove();$form.find('input[name="sq_nonce"]').val(sqQuery.nonce);$button.addClass("sq_minloading");$.post(sqQuery.ajaxurl,$form.serialize()).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){if(response.success){$.sq_showMessage(response.data).addClass("sq_success")}else{$.sq_showMessage(response.data).addClass("sq_error")}}$form.trigger("sqd_jsonld_reusable_form_submit")}).fail(function(){$button.removeClass("sq_minloading");$.sq_showMessage(__("An error occurred, please refresh the page.","hide-my-wp")).addClass("sq_error")});return false});$form.on("submit",function(){var $button=$form.find("button[type=submit]");$button.addClass("sq_minloading");$.post(sqQuery.ajaxurl,$form.serialize()).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){if(response.success){$.sq_showMessage(response.data).addClass("sq_success")}else{$.sq_showMessage(response.data).addClass("sq_error")}}$form.trigger("sqd_jsonld_form_submit")}).fail(function(){$button.removeClass("sq_minloading");$.sq_showMessage(__("An error occurred, please refresh the page.","hide-my-wp")).addClass("sq_error")});return false})};$.fn.sq_listenAddField=function(){var $form=this;$form.find(".sq_jsonld_add_item").on("click",function(){var $field=$(this);var $name=$field.data("name");var $index=$form.find(".sq_subgroup."+$name).length;$field.addClass("sq_minloading");$.post(sqQuery.ajaxurl,{action:"sqp_jsonld_add_key",post_id:$form.post_id,term_id:$form.term_id,taxonomy:$form.taxonomy,post_type:$form.post_type,jsonld_type:$form.jsonld_type,name:$name,index:$index,sq_nonce:sqQuery.nonce}).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){if(response.success){$field.before(response.data);$form.sq_listenDeleteField();$("body").trigger("sqd_jsonld_added_keys",[$form])}}$field.removeClass("sq_minloading")}).fail(function(){$field.removeClass("sq_minloading")})})};$.fn.sq_listenDeleteField=function(){var $form=this;$form.find(".sq_jsonld_delete_item").on("click",function(){var $button=$(this);var $div=$(this).parents(".sq_subgroup:last");if(typeof $button.data("confirm")!=="undefined"){if(confirm($button.data("confirm"))){$div.remove()}}else{$div.remove()}})};$.fn.sq_listenDependency=function(){var $form=this;$form.find("*[data-dependency]").each(function(){var $field=$(this);var $dependency=$form.find("select[name*='"+$field.data("dependency")+"']");var $value=$(this).data("value");if($dependency.length){if($.inArray("sq_subgroup",$field.parent("div").attr("class").split(" "))!==-1){$field=$field.parent("div")}$dependency.on("click",function(){var $dependency_value=$(this).val();if($(this).attr("type")=="radio"){$dependency_value=$(this).is(":checked")?$(this).val():false}if($.inArray($dependency_value,$value.split(","))!==-1){$field.show()}else{$field.hide()}});$dependency.trigger("click")}})};$.fn.sq_getJsonType=function(post_id,term_id,taxonomy,post_type,jsonld_type,jsonld_id){var $this=this;$this.addClass("sq_minloading");return $.post(sqQuery.ajaxurl,{action:"sqp_jsonld_edit",post_id:post_id,term_id:term_id,taxonomy:taxonomy,post_type:post_type,jsonld_type:jsonld_type,jsonld_id:jsonld_id,sq_nonce:sqQuery.nonce}).done(function(response){$this.removeClass("sq_minloading")}).fail(function(){$this.removeClass("sq_minloading");$.sq_showMessage(__("An error occurred, please refresh the page.","hide-my-wp")).addClass("sq_error")})};$.fn.sqp_Schemas=function(){var $this=this;var $preview=false;var $snippet=this;$this.init=function(){$this.on("sq_snippet_loaded sq_bulkseo_snippet_loaded",function(e,$ctab){e.stopImmediatePropagation();$this.post_id=$snippet.find("input[name=sq_post_id]").length?$snippet.find("input[name=sq_post_id]").val():$snippet.find("input[name=post_id]").val();$this.term_id=$snippet.find("input[name=sq_term_id]").length?$snippet.find("input[name=sq_term_id]").val():$snippet.find("input[name=term_id]").val();$this.taxonomy=$snippet.find("input[name=sq_taxonomy]").length?$snippet.find("input[name=sq_taxonomy]").val():$snippet.find("input[name=taxonomy]").val();$this.post_type=$snippet.find("input[name=sq_post_type]").length?$snippet.find("input[name=sq_post_type]").val():$snippet.find("input[name=post_type]").val();$this.jsonld_type=$snippet.find("input[name=sq_jsonld_type]").length?$snippet.find("input[name=sq_jsonld_type]").val():$snippet.find("input[name=jsonld_type]").val();$this.trigger("sqp_snippet_loaded");var clipboard=new ClipboardJS(".sq-copy");clipboard.on("success",function(e){$(e.trigger).text(__("Copied","squirrly-seo-pack"))});$snippet.find(".sq_snippet_submenu").find(".sq-nav-tabs .sq-nav-item:first a").on("click",function(){$preview=false});$snippet.find(".sq_snippet_submenu").find(".sq-nav-tabs .sq-nav-item:nth-child(2) a").on("click",function(){$preview=true;$this.snippetPreview()});$this.find(".sq_snippet_menu").find(".sq-nav-item.sq-nav-link").on("click",function(){var $navitem=$(this);setTimeout(function(){var $parent=$navitem.parents(".sq_blocksnippet:last").find(".sq-tab-panel.active");if($preview){if($parent.find(".sq-nav-item:nth-child(2) a").length){$parent.find(".sq-nav-item:nth-child(2) a").trigger("click")}else{$parent.find(".sq-nav-item:first a").trigger("click");$preview=true}}else{$parent.find(".sq-nav-item:first a").trigger("click")}},1)});$this.snippetListenTypes();$this.snippetListenTypeEdit()});$("body").on("sqd_jsonld_modal_show sqd_jsonld_added_keys",function(e,$modal){$modal.sq_listenSearch();$modal.find(".timepicker input.sq-form-control").datetimepicker({format:"H:i",formatTime:"H:i",datepicker:false});$modal.find(".datetimepicker input.sq-form-control").datetimepicker({formatTime:"H:i",formatDate:"d.m.Y"});$modal.find(".datepicker input.sq-form-control").datetimepicker({timepicker:false,formatDate:"d.m.Y"});if($.isFunction($.fn.sq_patterns)){$modal.find(".sq_pattern_field").each(function(){$(this).sq_patterns().init()})}})};$this.snippetListenTypes=function(){$snippet.find(".sq_jsonld_show_types").on("click",function(){var $button=$(this);$button.addClass("sq_minloading");$.post(sqQuery.ajaxurl,{action:"sqp_jsonld_get_jsonld_types",post_id:$this.post_id,term_id:$this.term_id,taxonomy:$this.taxonomy,post_type:$this.post_type,sq_nonce:sqQuery.nonce}).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){if(response.success){var $modal=$(response.data);$modal.sq_Modal("show");$modal.find(".sq_jsonld_type_add").on("click",function(){var $jsonld_type=$(this).data("jsonld-type");$(this).sq_getJsonType($this.post_id,$this.term_id,$this.taxonomy,$this.post_type,$jsonld_type).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){if(response.success){$modal.sq_Modal("hide");$modal=$(response.data);$modal.sq_Modal("show");$modal.find("form").sq_listenForm();$modal.find("form").on("sqd_jsonld_form_submit",function(){var sq_jsonld_types=$snippet.find(".sq_jsonld_types").val();sq_jsonld_types.push($jsonld_type);$snippet.find(".sq_jsonld_types").val(sq_jsonld_types);$snippet.sq_jsonld_types=sq_jsonld_types;$snippet.find(".sq_snippet_btn_save:first").trigger("click");$modal.sq_Modal("hide")});$modal.find("form").on("sqd_jsonld_reusable_form_submit",function(){$modal.sq_Modal("hide");$snippet.find(".sq_snippet_btn_refresh").trigger("click")})}else{$.sq_showMessage(response.data).addClass("sq_error")}}})})}else{$.sq_showMessage(response.data).addClass("sq_error")}}$button.removeClass("sq_minloading")}).fail(function(){$button.removeClass("sq_minloading");$.sq_showMessage(__("An error occurred, please refresh the page.","hide-my-wp")).addClass("sq_error")})});$snippet.find(".sq_jsonld_show_reusable_types").on("click",function(){var $button=$(this);$button.addClass("sq_minloading");$.post(sqQuery.ajaxurl,{action:"sqp_jsonld_get_reusable_jsonld_types",post_id:$this.post_id,term_id:$this.term_id,taxonomy:$this.taxonomy,post_type:$this.post_type,sq_nonce:sqQuery.nonce}).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){if(response.success){var $modal=$(response.data);$modal.sq_Modal("show");$modal.find(".sq_jsonld_type_add").on("click",function(){var $jsonld_type=$(this).data("jsonld-type");var $jsonld_id=$(this).data("jsonld-id");$(this).sq_getJsonType($this.post_id,$this.term_id,$this.taxonomy,$this.post_type,$jsonld_type,$jsonld_id).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){if(response.success){$modal.sq_Modal("hide");$modal=$(response.data);$modal.sq_Modal("show");$modal.find("form").sq_listenForm();$modal.find("form").on("sqd_jsonld_form_submit",function(){var sq_jsonld_types=$snippet.find(".sq_jsonld_types").val();sq_jsonld_types.push($jsonld_type);$snippet.find(".sq_jsonld_types").val(sq_jsonld_types);$snippet.sq_jsonld_types=sq_jsonld_types;$snippet.find(".sq_snippet_btn_save:first").trigger("click");$modal.sq_Modal("hide")});$modal.find("form").on("sqd_jsonld_reusable_form_submit",function(){$modal.sq_Modal("hide");$snippet.find(".sq_snippet_btn_refresh").trigger("click")})}else{$.sq_showMessage(response.data).addClass("sq_error")}}})})}else{$.sq_showMessage(response.data).addClass("sq_error")}}$button.removeClass("sq_minloading")}).fail(function(){$button.removeClass("sq_minloading");$.sq_showMessage(__("An error occurred, please refresh the page.","hide-my-wp")).addClass("sq_error")})})};$this.snippetListenTypeEdit=function(){$snippet.find(".sq_dropdown_parent").each(function(){var $parent=$(this);var $icon=$parent.find(".sq_dropdown_icon");var $delete=$parent.find(".sq_jsonld_type_delete");$delete.on("click",function(){if(confirm("Are you sure?")){$delete.addClass("sq_minloading");$.post(sqQuery.ajaxurl,{action:"sqp_jsonld_delete",post_id:$this.post_id,term_id:$this.term_id,taxonomy:$this.taxonomy,post_type:$this.post_type,jsonld_type:$parent.data("jsonld-type"),sq_nonce:sqQuery.nonce}).done(function(response){var sq_jsonld_types=$snippet.find(".sq_jsonld_types").val();sq_jsonld_types.splice($.inArray($parent.data("jsonld-type"),sq_jsonld_types),1);$snippet.find(".sq_jsonld_types").val(sq_jsonld_types);$snippet.find(".sq_snippet_btn_save:first").trigger("click")})}});$icon.on("click",function(){$icon.sq_getJsonType($this.post_id,$this.term_id,$this.taxonomy,$this.post_type,$parent.data("jsonld-type"),$parent.data("jsonld-id")).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){if(response.success){var $modal=$(response.data);$modal.sq_Modal("show");$modal.find("form").sq_listenForm();$modal.find("form").on("sqd_jsonld_form_submit",function(){$modal.sq_Modal("hide")});$modal.find("form").on("sqd_jsonld_reusable_form_submit",function(){$modal.sq_Modal("hide");$snippet.find(".sq_snippet_btn_refresh").trigger("click")})}else{$.sq_showMessage(response.data).addClass("sq_error")}}})})})};$this.snippetPreview=function(){$snippet.find(".code_snippet").addClass("sq_minloading");$.post(sqQuery.ajaxurl,{action:"sqp_jsonld_preview",post_id:$this.post_id,term_id:$this.term_id,taxonomy:$this.taxonomy,post_type:$this.post_type,sq_nonce:sqQuery.nonce}).done(function(response){if(typeof response.success!=="undefined"&&typeof response.data!=="undefined"){$snippet.find(".code_snippet").removeClass("sq_minloading");if(response.success){$snippet.find(".code_snippet").text(response.data)}else{$.sq_showMessage(response.data).addClass("sq_error")}}}).fail(function(){$snippet.find(".code_snippet").removeClass("sq_minloading")})};return $this};$(document).ready(function(){if($(sqp_jsonld.wrap).length>0){$(sqp_jsonld.wrap).each(function(){$(this).sqp_Schemas().init()})}})})(jQuery);